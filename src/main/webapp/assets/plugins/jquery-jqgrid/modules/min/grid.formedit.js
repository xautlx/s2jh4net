!function(e,t){"use strict";"function"==typeof define&&define.amd?define(["jquery","./grid.base","./jquery.fmatter","./grid.common","./grid.filter"],function(a){return t(a,e,e.document)}):"object"==typeof module&&module.exports?module.exports=function(e,a){return e||(e=window),void 0===a&&(a="undefined"!=typeof window?require("jquery"):require("jquery")(e)),require("./grid.base"),require("./jquery.fmatter"),require("./grid.common"),require("./grid.filter"),t(a,e,e.document),a}:t(jQuery,e,e.document)}("undefined"!=typeof window?window:this,function(e,t,a){"use strict";var i=e.jgrid,l=i.jqID,r=e.fn.jqGrid,o=r.getGuiStyles,n=i.mergeCssClasses,d=i.hasOneFromClasses,s=i.feedback,c=i.fullBoolFeedback,u=i.builderFmButon,p=function(e,t,a){var i;!0===t[0]&&(i="<span class='"+n("fm-button-icon",a,t[2])+"'></span>","right"===t[1]?e.addClass("fm-button-icon-right").append(i):e.addClass("fm-button-icon-left").prepend(i))},f=function(e){return o.call(this,"states."+e)},h=function(t){t.find("tr[data-rowpos]").each(function(){var t=0;e(this).children("td").each(function(){"hidden"!==e(this).css("visibility")&&t++}),t||e(this).hide()})},m=function(e){return"&nbsp;"===e||"&#160;"===e||1===e.length&&160===e.charCodeAt(0)};i.extend({searchGrid:function(t){return this.each(function(){function a(t){k("beforeShow",t)&&(e(y).data("onClose",m.onClose),i.viewModal.call(d,y,{gbox:w,jqm:m.jqModal,overlay:m.overlay,modal:m.modal,overlayClass:m.overlayClass,toTop:m.toTop,onHide:function(e){e.w.remove(),e.o&&e.o.remove()}}),k("afterShow",t))}var d=this,p=e(d),h=d.p;if(d.grid&&null!=h){var m=e.extend(!0,{drag:!0,sField:"searchField",sValue:"searchString",sOper:"searchOper",sFilter:h.prmNames.filters,loadDefaults:!0,beforeShowSearch:null,afterShowSearch:null,onInitializeSearch:null,afterRedraw:null,afterChange:null,closeAfterSearch:!1,closeAfterReset:!1,closeOnEscape:!1,searchOnEnter:!1,multipleSearch:!1,multipleGroup:!1,top:0,left:0,removemodal:!0,resize:!0,width:450,height:"auto",dataheight:"auto",showQuery:!1,errorcheck:!0,sopt:null,stringResult:void 0,onClose:null,onSearch:null,onReset:null,columns:[],tmplNames:null,tmplFilters:null,tmplLabel:" Template: ",showOnLoad:!1,layer:null,operands:{eq:"=",ne:"<>",lt:"<",le:"<=",gt:">",ge:">=",bw:"LIKE",bn:"NOT LIKE",in:"IN",ni:"NOT IN",ew:"LIKE",en:"NOT LIKE",cn:"LIKE",nc:"NOT LIKE",nu:"IS NULL",nn:"IS NOT NULL"}},r.getGridRes.call(p,"search"),i.search||{},h.searching||{},t||{}),v="fbox_"+h.id,g=m.commonIconClass,b={themodal:"searchmod"+v,modalhead:"searchhd"+v,modalcontent:"searchcnt"+v,resizeAlso:v},y="#"+l(b.themodal),w=h.gBox,x=h.gView,D=e.each,C=h.postData[m.sFilter],k=function(){var t=e.makeArray(arguments);return t.unshift("Search"),t.unshift("Filter"),t.unshift(m),s.apply(d,t)},F=function(){i.hideModal(y,{gb:w,jqm:m.jqModal,onClose:m.onClose,removemodal:m.removemodal})};if("string"==typeof C&&(C=""!==e.trim(C)?e.parseJSON(C):void 0),e(y).remove(),void 0!==e(y)[0])a(e("#fbox_"+l(h.id)));else{var _=e("<div><div id='"+v+"' class='"+o.call(d,"dialog.body","searchFilter")+"' style='overflow:auto'></div></div>").insertBefore(x);"rtl"===h.direction&&_.attr("dir","rtl");var E,S,j="",O="",q=!1,T=-1,A=e.extend([],h.colModel),G=u.call(d,v+"_search",m.Find,n(g,m.findDialogIcon),"right"),I=u.call(d,v+"_reset",m.Reset,n(g,m.resetDialogIcon),"left");if(m.showQuery&&(j=u.call(d,v+"_query","Query",n(g,m.queryDialogIcon),"left")+"&#160;"),m.searchForAdditionalProperties&&D(h.additionalProperties,function(){var e="string"==typeof this?{name:this}:this;e.label||(e.label=e.name),e.isAddProp=!0,A.push(e)}),m.columns.length?(A=m.columns,T=0,E=A[0].index||A[0].name):D(A,function(e,t){if(t.label||(t.label=t.isAddProp?t.name:h.colNames[e]),!q){var a=void 0===t.search||t.search,i=!0===t.hidden;(t.searchoptions&&!0===t.searchoptions.searchhidden&&a||a&&!i)&&(q=!0,E=t.index||t.name,T=e)}}),!C&&E||!1===m.multipleSearch){var B="eq";T>=0&&A[T].searchoptions&&A[T].searchoptions.sopt?B=A[T].searchoptions.sopt[0]:m.sopt&&m.sopt.length&&(B=m.sopt[0]),C={groupOp:"AND",rules:[{field:E,op:B,data:""}]}}q=!1,m.tmplNames&&m.tmplNames.length&&(q=!0,O=m.tmplLabel,O+="<select class='ui-template'>",O+="<option value='default'>Default</option>",D(m.tmplNames,function(e,t){O+="<option value='"+e+"'>"+t+"</option>"}),O+="</select>"),S="<div class='"+o.call(d,"dialog.footer")+"'><table class='EditTable' style='border:0px none;margin-top:5px' id='"+v+"_2'><tbody><tr><td colspan='2'><hr class='"+o.call(d,"dialog.hr")+"' style='margin:1px'/></td></tr><tr><td class='EditButton EditButton-"+h.direction+"'  style='float:"+("rtl"===h.direction?"right":"left")+";'>"+I+O+"</td><td class='EditButton EditButton-"+h.direction+"'>"+j+G+"</td></tr></tbody></table></div>",v=l(v),m.gbox=w,m.height="auto",e(v="#"+v).jqFilter({columns:A,filter:m.loadDefaults?C:null,showQuery:m.showQuery,errorcheck:m.errorcheck,sopt:m.sopt,groupButton:m.multipleGroup,ruleButtons:m.multipleSearch,afterRedraw:m.afterRedraw,ops:m.odata,cops:h.customSortOperations,operands:m.operands,ajaxSelectOptions:h.ajaxSelectOptions,groupOps:m.groupOps,onChange:function(t,a){t.showQuery&&e(".query",a).text(a.toUserFriendlyString()),c.call(d,m.afterChange,"jqGridFilterAfterChange",e(v),m,t,a)},direction:h.direction,id:h.id}),_.append(S),q&&m.tmplFilters&&m.tmplFilters.length&&e(".ui-template",_).on("change",function(){var t=e(this).val();return"default"===t?e(v).jqFilter("addFilter",C):e(v).jqFilter("addFilter",m.tmplFilters[parseInt(t,10)]),!1}),!0===m.multipleGroup&&(m.multipleSearch=!0),k("onInitialize",e(v)),m.layer?i.createModal.call(d,b,_,m,x,e(w)[0],"#"+l(m.layer),{position:"relative"}):i.createModal.call(d,b,_,m,x,e(w)[0]),(m.searchOnEnter||m.closeOnEscape)&&e(y).keydown(function(t){var a=e(t.target);return!m.searchOnEnter||13!==t.which||a.hasClass("add-group")||a.hasClass("add-rule")||a.hasClass("delete-group")||a.hasClass("delete-rule")||a.hasClass("fm-button")&&a.is("[id$=_query]")?m.closeOnEscape&&27===t.which?(e("#"+l(b.modalhead)).find(".ui-jqdialog-titlebar-close").click(),!1):void 0:(e(v+"_search").click(),!1)}),j&&e(v+"_query").on("click",function(){return e(".queryresult",_).toggle(),!1}),void 0===m.stringResult&&(m.stringResult=m.multipleSearch),e(v+"_search").on("click",function(){var t,a={},i="",l=e(v),r=l.find(".input-elm");if(r.filter(":focus")&&(r=r.filter(":focus")),r.change(),t=l.jqFilter("filterData"),m.errorcheck&&(l[0].hideError(),m.showQuery||l.jqFilter("toSQLString"),l[0].p.error))return l[0].showError(),!1;if(m.stringResult||"local"===h.datatype){try{i=JSON.stringify(t)}catch(e){}"string"==typeof i&&(a[m.sFilter]=i,D([m.sField,m.sValue,m.sOper],function(){a[this]=""}))}else m.multipleSearch?(a[m.sFilter]=t,D([m.sField,m.sValue,m.sOper],function(){a[this]=""})):(a[m.sField]=t.rules[0].field,a[m.sValue]=t.rules[0].data,a[m.sOper]=t.rules[0].op,a[m.sFilter]="");return e.extend(h.postData,a),c.call(d,m.onSearch,"jqGridFilterSearch",h.filters)&&(h.search=!0,p.trigger("reloadGrid",[e.extend({page:1},m.reloadGridSearchOptions||{})])),m.closeAfterSearch&&F(),!1}),e(v+"_reset").on("click",function(){var t={},a=e(v);return h.search=!1,h.resetsearch=!0,!1===m.multipleSearch?t[m.sField]=t[m.sValue]=t[m.sOper]="":t[m.sFilter]="",a[0].resetFilter(),q&&e(".ui-template",_).val("default"),e.extend(h.postData,t),c.call(d,m.onReset,"jqGridFilterReset")&&p.trigger("reloadGrid",[e.extend({page:1},m.reloadGridResetOptions||{})]),m.closeAfterReset&&F(),!1}),a(e(v));var N=f.call(d,"hover");e(".fm-button:not(."+f.call(d,"disabled").split(" ").join(".")+")",_).hover(function(){e(this).addClass(N)},function(){e(this).removeClass(N)})}}})},editGridRow:function(t,a){return this.each(function(){function c(){return e(B+" > tbody > tr > td .FormElement").each(function(){var t,a,r,o,n,d=e(".customelement",this),s=this.name;if(d.length){if(s=d.attr("name"),void 0!==(a=V[s])&&(t=z[a],r=t.editoptions||{},e.isFunction(r.custom_value))){try{if(_[s]=r.custom_value.call(C,e("#"+l(s),B),"get"),void 0===_[s])throw"e1"}catch(e){"e1"===e?i.info_dialog.call(C,K,"function 'custom_value' "+T.msg.novalue,T.bClose):i.info_dialog.call(C,K,e.message,T.bClose)}return!0}}else switch(n=e(this)[0].type){case"checkbox":_[s]=e(this).is(":checked")?e(this).val():e(this).data("offval");break;case"select-one":_[s]=e("option:selected",this).val();break;case"select-multiple":_[s]=e(this).val(),_[s]=_[s]?_[s].join(","):"";var c=[];e("option:selected",this).each(function(t,a){c[t]=e(a).text()});break;case"date":_[s]=e(this).val(),3===String(_[s]).split("-").length&&void 0!==(a=V[s])&&(o=((t=z[a]).formatoptions||{}).newformat||O.call(k,"formatter.date.newformat"),_[s]=i.parseDate.call(k[0],"Y-m-d",_[s],o));break;default:void 0!==n&&e.inArray(n,T.skipPostTypes)<0&&(_[s]=e(this).val())}}),!0}function v(t,a){var o,n,d,s,c,u=0;(T.checkOnSubmit||T.checkOnUpdate)&&(T._savedData={},T._savedData[j+"_id"]=t);var p=F.colModel;if("_empty"===t)return e(p).each(function(){o=this.name,d=e.extend({},this.editoptions||{}),(n=e("#"+l(o),a))&&n.length&&null!==n[0]&&(s="","custom"===this.edittype&&e.isFunction(d.custom_value)?d.custom_value.call(C,n,"set",s):d.defaultValue?(s=e.isFunction(d.defaultValue)?d.defaultValue.call(C):d.defaultValue,"checkbox"===n[0].type?(c=s.toLowerCase()).search(/(false|f|0|no|n|off|undefined)/i)<0&&""!==c?(n[0].checked=!0,n[0].defaultChecked=!0,n[0].value=s):(n[0].checked=!1,n[0].defaultChecked=!1):n.val(s)):"checkbox"===n[0].type?(n[0].checked=!1,n[0].defaultChecked=!1,s=e(n).data("offval")):n[0].type&&"select"===n[0].type.substr(0,6)?n[0].selectedIndex=0:n.val(s),(!0===T.checkOnSubmit||T.checkOnUpdate)&&(T._savedData[o]=s))}),void e("#id_g",a).val(t);var f=r.getInd.call(k,t,!0);f&&(e(f.cells).filter("td[role=gridcell]").each(function(r){var n;if("cb"!==(o=p[r].name)&&"subgrid"!==o&&"rn"!==o&&!0===p[r].editable){try{n=e.unformat.call(C,e(this),{rowId:t,colModel:p[r]},r)}catch(t){n="textarea"===p[r].edittype?e(this).text():e(this).html()}switch(F.autoEncodeOnEdit&&(n=i.oldDecodePostedData(n)),(!0===T.checkOnSubmit||T.checkOnUpdate)&&(T._savedData[o]=n),o="#"+l(o),p[r].edittype){case"password":case"text":case"button":case"image":case"textarea":m(n)&&(n=""),e(o,a).val(n);break;case"select":var d=n.split(",");d=e.map(d,function(t){return e.trim(t)}),e(o+" option",a).each(function(){var t,a=this,i=e(a),l=e.trim(i.val());if(p[r].editoptions.multiple||d[0]!==l?p[r].editoptions.multiple&&(t=e.inArray(l,d))>-1?(d.splice(t,1),a.selected=!0):a.selected=!1:(d.splice(0,1),a.selected=!0),0===d.length)return!1}),d.length>0&&e(o+" option",a).each(function(){var t,a=this,i=e(a),l=e.trim(i.text());if(p[r].editoptions.multiple||e.trim(n)!==l&&d[0]!==l?p[r].editoptions.multiple&&(t=e.inArray(l,d))>-1&&(d.splice(t,1),a.selected=!0):(d.splice(0,1),a.selected=!0),0===d.length)return!1});break;case"checkbox":n=String(n),p[r].editoptions&&p[r].editoptions.value?n=p[r].editoptions.value.split(":")[0]===n:(n=n.toLowerCase(),n=n.search(/(false|f|0|no|n|off|undefined)/i)<0&&""!==n),e(o,a).prop({checked:n,defaultChecked:n});break;case"custom":try{if(!p[r].editoptions||!e.isFunction(p[r].editoptions.custom_value))throw"e1";p[r].editoptions.custom_value.call(C,e(o,a),"set",n)}catch(e){"e1"===e?i.info_dialog.call(C,K,"function 'custom_value' "+T.msg.nodefined,T.bClose):i.info_dialog.call(C,K,e.message,T.bClose)}}u++}}),u>0&&e("#id_g",B).val(t))}function g(){var t=T.url||F.editurl;e.each(z,function(a,i){var l=i.name;_.hasOwnProperty(l)&&("date"!==i.formatter||null!=i.formatoptions&&!0===i.formatoptions.sendFormatted||(_[l]=e.unformat.date.call(C,_[l],i)),"clientArray"!==t&&i.editoptions&&!0===i.editoptions.NullIfEmpty&&""===_[l]&&(_[l]="null"))})}function b(){var a,l,o,n,d,s,c,u,p=[!0,"",""],f=p,h={},m=F.prmNames,b=r.getInd.call(k,t),y=!1===b?null:C.rows[b],w=k.triggerHandler("jqGridAddEditBeforeCheckValues",[_,e(A),S]);w&&"object"==typeof w&&(_=w),b=!1===b?-1:b,e.isFunction(T.beforeCheckValues)&&(w=T.beforeCheckValues.call(C,_,e(A),S))&&"object"==typeof w&&(_=w);for(o in _)if(_.hasOwnProperty(o)&&(u=F.iColByName[o],null!=(f=i.checkValues.call(C,_[o],o,void 0,void 0,{oldValue:"_empty"===t?null:r.getCell.call(k,t,u),newValue:_[o],cmName:o,rowid:t,cm:z[u],iCol:u,iRow:b,tr:y,td:null==y?null:y.cells[u],mode:"_empty"===t?"addForm":"editForm"}))&&!0!==f||(f=p),!1===f[0]))break;if(g(),f[0]&&(void 0===(h=k.triggerHandler("jqGridAddEditClickSubmit",[T,_,S]))&&e.isFunction(T.onclickSubmit)&&(h=T.onclickSubmit.call(C,T,_,S)||{}),null!=(f=k.triggerHandler("jqGridAddEditBeforeSubmit",[_,e(A),S]))&&!0!==f||(f=p),f[0]&&e.isFunction(T.beforeSubmit)&&(null!=(f=T.beforeSubmit.call(C,_,e(A),S))&&!0!==f||(f=p))),f[0]&&!T.processing){if(T.processing=!0,e("#sData",N).addClass($),s=T.url||F.editurl,l=m.oper,a="clientArray"===s&&!1!==F.keyName?F.keyName:m.id,_[l]="_empty"===e.trim(_[j+"_id"])?m.addoper:m.editoper,_[l]!==m.addoper?_[a]=_[j+"_id"]:void 0===_[a]&&(_[a]=_[j+"_id"]),delete _[j+"_id"],_=e.extend(_,T.editData,h),!0===F.treeGrid){if(_[l]===m.addoper){n=F.selrow;var x="adjacency"===F.treeGridModel?F.treeReader.parent_id_field:"parent_id";_[x]=n}for(d in F.treeReader)if(F.treeReader.hasOwnProperty(d)&&(c=F.treeReader[d],_.hasOwnProperty(c))){if(_[l]===m.addoper&&"parent_id_field"===d)continue;delete _[c]}}_[a]=i.stripPref(F.idPrefix,_[a]),F.autoEncodeOnEdit&&e.each(_,function(t,a){e.isFunction(a)||(_[t]=i.oldEncodePostedData(a))});var D=e.extend({url:e.isFunction(s)?s.call(C,_[a],S,_,T):s,type:e.isFunction(T.mtype)?T.mtype.call(C,S,T,_[a],_):T.mtype,data:i.serializeFeedback.call(C,e.isFunction(T.serializeEditData)?T.serializeEditData:F.serializeEditData,"jqGridAddEditSerializeEditData",_),complete:function(t,o){if(k.jqGrid("progressBar",{method:"hide",loadtype:T.saveui}),e("#sData",N).removeClass($),_[a]=e("#id_g",B).val(),t.status>=300&&304!==t.status||0===t.status&&4===t.readyState?(f[0]=!1,f[1]=k.triggerHandler("jqGridAddEditErrorTextFormat",[t,S]),e.isFunction(T.errorTextFormat)?f[1]=T.errorTextFormat.call(C,t,S):f[1]=o+" Status: '"+t.statusText+"'. Error code: "+t.status):(null!=(f=k.triggerHandler("jqGridAddEditAfterSubmit",[t,_,S]))&&!0!==f||(f=p),f[0]&&e.isFunction(T.afterSubmit)&&(null!=(f=T.afterSubmit.call(C,t,_,S))&&!0!==f||(f=p))),!1===f[0])e("#FormError>td",B).html(f[1]),e("#FormError",B).show();else{F.autoEncodeOnEdit&&e.each(_,function(e,t){_[e]=i.oldDecodePostedData(t)});var d=[e.extend({},T.reloadGridOptions||{})];if(_[l]===m.addoper?(f[2]||(f[2]=i.randId()),null==_[a]||"_empty"===_[a]||_[l]===m.addoper?_[a]=f[2]:f[2]=_[a],T.reloadAfterSubmit?k.trigger("reloadGrid",d):!0===F.treeGrid?r.addChildNode.call(k,f[2],n,_):r.addRowData.call(k,f[2],_,T.addedrow),T.closeAfterAdd?(!0!==F.treeGrid&&q.call(k,f[2]),Q()):T.clearAfterAdd&&v("_empty",A)):(T.reloadAfterSubmit?(k.trigger("reloadGrid",d),T.closeAfterEdit||setTimeout(function(){q.call(k,_[a])},1e3)):!0===F.treeGrid?r.setTreeRow.call(k,_[a],_):r.setRowData.call(k,_[a],_),T.closeAfterEdit&&Q()),e.isFunction(T.afterComplete)){var s=t;setTimeout(function(){k.triggerHandler("jqGridAddEditAfterComplete",[s,_,e(A),S]),T.afterComplete.call(C,s,_,e(A),S),s=null},50)}if((T.checkOnSubmit||T.checkOnUpdate)&&(e(A).data("disabled",!1),"_empty"!==T._savedData[j+"_id"])){var c;for(c in T._savedData)T._savedData.hasOwnProperty(c)&&_[c]&&(T._savedData[c]=_[c])}}T.processing=!1;try{e(A).find("input,textarea,select,button,object,*[tabindex]").filter(":input:visible:not(:disabled)").first().focus()}catch(e){}}},i.ajaxOptions,T.ajaxEditOptions);if(D.url||T.useDataProxy||(e.isFunction(F.dataProxy)?T.useDataProxy=!0:(f[0]=!1,f[1]+=" "+i.errors.nourl)),f[0])if(k.jqGrid("progressBar",{method:"show",loadtype:T.saveui,htmlcontent:T.savetext}),T.useDataProxy){var E=F.dataProxy.call(C,D,"set_"+j);void 0===E&&(E=[!0,""]),!1===E[0]?(f[0]=!1,f[1]=E[1]||"Error deleting the selected row!"):(D.data.oper===m.addoper&&T.closeAfterAdd&&Q(),D.data.oper===m.editoper&&T.closeAfterEdit&&Q())}else"clientArray"===D.url?(T.reloadAfterSubmit=!1,_=D.data,D.complete({status:200,statusText:""},"")):e.ajax(D)}!1===f[0]&&(e("#FormError>td",B).html(f[1]),e("#FormError",B).show())}function y(e,t){var a,i=!1;for(a in e)if(e.hasOwnProperty(a)&&String(e[a])!==String(t[a])){i=!0;break}return i}function w(){var t=!0;return e("#FormError",B).hide(),T.checkOnUpdate&&(_={},c(),(E=y(_,T._savedData))&&(e(A).data("disabled",!0),e(".confirm",R).show(),t=!1)),t}function x(t,a){var i=a[1].length-1;0===t?e("#pData",N).addClass(Y):void 0!==a[1][t-1]&&d(e("#"+l(a[1][t-1])),Y)?e("#pData",N).addClass(Y):e("#pData",N).removeClass(Y),t===i?e("#nData",N).addClass(Y):void 0!==a[1][t+1]&&d(e("#"+l(a[1][t+1])),Y)?e("#nData",N).addClass(Y):e("#nData",N).removeClass(Y)}function D(){var t=r.getDataIDs.call(k),a=e("#id_g",B).val();return[e.inArray(a,t),t]}var C=this,k=e(C),F=C.p;if(C.grid&&null!=F&&t){var _,E,S,j=F.id,O=r.getGridRes,q=r.setSelection,T=e.extend(!0,{top:0,left:0,width:300,datawidth:"auto",height:"auto",dataheight:"auto",drag:!0,resize:!0,url:null,mtype:"POST",clearAfterAdd:!0,closeAfterEdit:!1,reloadAfterSubmit:!0,onInitializeForm:null,beforeInitData:null,beforeShowForm:null,afterShowForm:null,beforeSubmit:null,afterSubmit:null,onclickSubmit:null,afterComplete:null,onclickPgButtons:null,afterclickPgButtons:null,editData:{},closeOnEscape:!1,addedrow:"first",topinfo:"",bottominfo:"",savekey:[!1,13],navkeys:[!1,38,40],checkOnSubmit:!1,checkOnUpdate:!1,_savedData:{},processing:!1,onClose:null,ajaxEditOptions:{},serializeEditData:null,viewPagerButtons:!0,overlayClass:o.call(this,"overlay"),removemodal:!0,skipPostTypes:["image","file"],saveui:"enable",savetext:O.call(k,"defaults.savetext")||"Saving..."},O.call(k,"edit"),i.edit,F.formEditing||{},a||{}),A="FrmGrid_"+j,G=A,I="TblGrid_"+j,B="#"+l(I),N=B+"_2",P={themodal:"editmod"+j,modalhead:"edithd"+j,modalcontent:"editcnt"+j,resizeAlso:A},R="#"+l(P.themodal),M=F.gBox,z=F.colModel,V=F.iColByName,L=1,U=0,H=T.commonIconClass,Q=function(){i.hideModal(R,{gb:M,jqm:T.jqModal,onClose:T.onClose,removemodal:T.removemodal})},K=O.call(k,"errors.errcap"),W=function(){var t=e.makeArray(arguments);return t.unshift(""),t.unshift("AddEdit"),t.unshift(T),s.apply(C,t)},X=f.call(C,"hover"),Y=f.call(C,"disabled"),J=f.call(C,"select"),$=f.call(C,"active"),Z=f.call(C,"error");e(R).remove(),A="#"+l(A),"new"===t?(t="_empty",S="add",T.caption=T.addCaption):(T.caption=T.editCaption,S="edit");var ee=!0;!T.checkOnUpdate||!0!==T.jqModal&&void 0!==T.jqModal||T.modal||(ee=!1);var te=isNaN(T.dataheight)?T.dataheight:T.dataheight+"px",ae=isNaN(T.datawidth)?T.datawidth:T.datawidth+"px",ie=e("<form name='FormPost' id='"+G+"' class='FormGrid' onSubmit='return false;' style='width:"+ae+";overflow:auto;position:relative;height:"+te+";'></form>").data("disabled",!1),le=e("<table id='"+I+"' class='EditTable'><tbody></tbody></table>");e(z).each(function(){var e=this.formoptions;L=Math.max(L,e?e.colpos||0:0),U=Math.max(U,e?e.rowpos||0:0)}),e(ie).append(le);var re=e("<tr id='FormError' style='display:none'><td class='"+Z+"' colspan='"+2*L+"'>&#160;</td></tr>");if(re[0].rp=0,e(le).append(re),re=e("<tr style='display:none' class='tinfo'><td class='topinfo' colspan='"+2*L+"'>"+(T.topinfo||"&#160;")+"</td></tr>"),re[0].rp=0,e(le).append(re),W("beforeInitData",ie,S)){!function(){var a=i.detectRowEditing.call(C,t);if(null!=a)if("inlineEditing"===a.mode)r.restoreRow.call(k,t);else{var l=a.savedRow,o=C.rows[l.id];r.restoreCell.call(k,l.id,l.ic),e(o.cells[l.ic]).removeClass("edit-cell "+J),e(o).addClass(J).attr({"aria-selected":"true",tabindex:"0"})}}();var oe="rtl"===F.direction,ne=oe?"nData":"pData",de=oe?"pData":"nData";!function(t,a,n){var d,s=0,c=[],u=!1,p=e(a),f="";for(d=1;d<=n;d++)f+="<td class='CaptionTD'>&#160;</td><td class='DataTD'>&#160;</td>";if("_empty"!==t&&(u=r.getInd.call(k,t)),e(z).each(function(a){var r,d,h,v,g,b=this,y=b.name,w=b.editable,x=!1,D=!1,_="_empty"===t?"addForm":"editForm";switch(e.isFunction(w)&&(w=w.call(C,{rowid:t,iCol:a,iRow:u,cmName:y,cm:b,mode:_})),d=!(b.editrules&&!0===b.editrules.edithidden||!0!==b.hidden&&"hidden"!==w),String(w).toLowerCase()){case"hidden":w=!0;break;case"disabled":w=!0,x=!0;break;case"readonly":w=!0,D=!0}if("cb"!==y&&"subgrid"!==y&&!0===w&&"rn"!==y){if(!1===u)v="";else{r=e(C.rows[u].cells[a]);try{v=e.unformat.call(C,r,{rowId:t,colModel:b},a)}catch(e){v=b.edittype&&"textarea"===b.edittype?r.text():r.html()}m(v)&&(v="")}var E=e.extend({},b.editoptions||{},{id:y,name:y,rowId:t,mode:_,cm:b,iCol:a}),S=e.extend({},{elmprefix:"",elmsuffix:"",rowabove:!1,rowcontent:""},b.formoptions||{}),j=parseInt(S.rowpos,10)||s+1,O=parseInt(2*(parseInt(S.colpos,10)||1),10);if("_empty"===t&&E.defaultValue&&(v=e.isFunction(E.defaultValue)?E.defaultValue.call(C):E.defaultValue),b.edittype||(b.edittype="text"),F.autoEncodeOnEdit&&(v=i.oldDecodePostedData(v)),g=i.createEl.call(C,b.edittype,E,v,!1,e.extend({},i.ajaxOptions,F.ajaxSelectOptions||{})),(T.checkOnSubmit||T.checkOnUpdate)&&(T._savedData[y]=v),e(g).addClass("FormElement"),e.inArray(b.edittype,["text","textarea","checkbox","password","select"])>-1&&e(g).addClass(o.call(C,"dialog.dataField")),h=p.find("tr[data-rowpos="+j+"]"),S.rowabove){var q=e("<tr><td class='contentinfo' colspan='"+2*n+"'>"+S.rowcontent+"</td></tr>");p.append(q),q[0].rp=j}0===h.length&&(h=e("<tr data-rowpos='"+j+"'></tr>").addClass("FormData").attr("id","tr_"+y),e(h).append(f),p.append(h),h[0].rp=j);var G=e("td:eq("+(O-2)+")",h[0]),I=e("td:eq("+(O-1)+")",h[0]);G.html(void 0===S.label?F.colNames[a]:S.label||"&#160;");var B=I[m(I.html())?"html":"append"](S.elmprefix);if(B.append(g).append(S.elmsuffix),"INPUT"===g.tagName.toUpperCase()&&b.createColumnIndex&&E.generateDatalist){var N=k.jqGrid("generateDatalistFromColumnIndex",b.name);null!=N&&N.length>0&&(e(g).attr("list","dl_"+g.id),B.append(N.attr("id","dl_"+g.id)))}x?(G.addClass(Y),I.addClass(Y),e(g).prop("readonly",!0),e(g).prop("disabled",!0)):D&&e(g).prop("readonly",!0),"custom"===b.edittype&&e.isFunction(E.custom_value)&&E.custom_value.call(C,e("#"+l(y),A),"set",v),i.bindEv.call(C,g,E),d&&G.add(I).css("visibility","hidden"),c[s]=a,s++}}),h(p),s>0){var v=e("<tr class='FormData' style='display:none'><td class='CaptionTD'>&#160;</td><td colspan='"+(2*n-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='"+j+"_id' value='"+t+"'/></td></tr>");v[0].rp=s+999,p.append(v),(T.checkOnSubmit||T.checkOnUpdate)&&(T._savedData[j+"_id"]=t)}}(t,le,L);var se=u.call(C,ne,"",n(H,T.prevIcon),"","left"),ce=u.call(C,de,"",n(H,T.nextIcon),"","right"),ue=u.call(C,"sData",T.bSubmit),pe=u.call(C,"cData",T.bCancel),fe="<div class='"+o.call(C,"dialog.footer")+"'><table class='EditTable' id='"+I+"_2'><tbody><tr><td colspan='2'><hr class='"+o.call(C,"dialog.hr")+"' style='margin:1px'/></td></tr><tr id='Act_Buttons'><td class='navButton navButton-"+F.direction+"'>"+(oe?ce+se:se+ce)+"</td><td class='EditButton EditButton-"+F.direction+"'>"+ue+"&#160;"+pe+"</td></tr>";if(fe+="<tr style='display:none' class='binfo'><td class='bottominfo' colspan='2'>"+(T.bottominfo||"&#160;")+"</td></tr>",fe+="</tbody></table></div>",U>0){var he=[];e.each(e(le)[0].rows,function(e,t){he[e]=t}),he.sort(function(e,t){return e.rp>t.rp?1:e.rp<t.rp?-1:0}),e.each(he,function(t,a){e("tbody",le).append(a)})}T.gbox=M;var me=!1;!0===T.closeOnEscape&&(T.closeOnEscape=!1,me=!0);var ve=e("<div></div>").append(e("<div class='"+o.call(C,"dialog.body")+"'></div>").append(ie)).append(fe);if(i.createModal.call(C,P,ve,T,F.gView,e(M)[0]),T.topinfo&&e(".tinfo",B).show(),T.bottominfo&&e(".binfo",N).show(),ve=null,fe=null,e(R).keydown(function(t){var a,i,l=(t.target.tagName||"").toUpperCase();if(!0===e(A).data("disabled"))return!1;if(13===t.which&&"TEXTAREA"!==l){if(a=e(N).find(":focus"),i=a.attr("id"),a.length>0&&e.inArray(i,["pData","nData","cData"])>=0)return a.trigger("click"),!1;if(!0===T.savekey[0]&&13===T.savekey[1])return e("#sData",N).trigger("click"),!1}if(!0===T.savekey[0]&&t.which===T.savekey[1]&&"TEXTAREA"!==l)return e("#sData",N).trigger("click"),!1;if(27===t.which)return!!w()&&(me&&Q(),!1);if(!0===T.navkeys[0]){if("_empty"===e("#id_g",B).val())return!0;if(t.which===T.navkeys[1])return e("#pData",N).trigger("click"),!1;if(t.which===T.navkeys[2])return e("#nData",N).trigger("click"),!1}}),T.checkOnUpdate&&(e("a.ui-jqdialog-titlebar-close span",R).removeClass("jqmClose"),e("a.ui-jqdialog-titlebar-close",R).off("click").click(function(){return!!w()&&(Q(),!1)})),p(e("#sData",N),T.saveicon,H),p(e("#cData",N),T.closeicon,H),T.checkOnSubmit||T.checkOnUpdate){ue=u.call(C,"sNew",T.bYes),ce=u.call(C,"nNew",T.bNo),pe=u.call(C,"cNew",T.bExit);var ge=T.zIndex||999;ge++,e("<div class='"+T.overlayClass+" jqgrid-overlay confirm' style='z-index:"+ge+";display:none;'>&#160;</div><div class='"+o.call(C,"dialog.content","confirm ui-jqconfirm")+"' style='z-index:"+(ge+1)+"'>"+T.saveData+"<br/><br/>"+ue+ce+pe+"</div>").insertAfter(A),e("#sNew",R).click(function(){return b(),e(A).data("disabled",!1),e(".confirm",R).hide(),!1}),e("#nNew",R).click(function(){return e(".confirm",R).hide(),e(A).data("disabled",!1),setTimeout(function(){e(A).find("input,textarea,select,button,object,*[tabindex]").filter(":input:visible:not(:disabled)").first().focus()},0),!1}),e("#cNew",R).click(function(){return e(".confirm",R).hide(),e(A).data("disabled",!1),Q(),!1})}W("onInitializeForm",e(A),S),"_empty"!==t&&T.viewPagerButtons?e("#pData,#nData",N).show():e("#pData,#nData",N).hide(),W("beforeShowForm",e(A),S),e(R).data("onClose",T.onClose),i.viewModal.call(C,R,{gbox:M,jqm:T.jqModal,overlay:T.overlay,modal:T.modal,overlayClass:T.overlayClass,toTop:T.toTop,onHide:function(e){e.w.remove(),e.o&&e.o.remove()}}),ee||e("."+l(T.overlayClass)).click(function(){return!!w()&&(Q(),!1)}),e(".fm-button",R).hover(function(){e(this).addClass(X)},function(){e(this).removeClass(X)}),e("#sData",N).click(function(){return _={},e("#FormError",B).hide(),c(),"_empty"===_[j+"_id"]?b():!0===T.checkOnSubmit&&(E=y(_,T._savedData))?(e(A).data("disabled",!0),e(".confirm",R).show()):b(),!1}),e("#cData",N).click(function(){return!!w()&&(Q(),!1)}),e("#nData",N).click(function(){if(!w())return!1;e("#FormError",B).hide();var t=D();if(t[0]=parseInt(t[0],10),-1!==t[0]&&t[1][t[0]+1]){if(!W("onclickPgButtons","next",e(A),t[1][t[0]]))return!1;v(t[1][t[0]+1],A),q.call(k,t[1][t[0]+1]),W("afterclickPgButtons","next",e(A),t[1][t[0]+1]),x(t[0]+1,t)}return!1}),e("#pData",N).click(function(){if(!w())return!1;e("#FormError",B).hide();var t=D();if(-1!==t[0]&&t[1][t[0]-1]){if(!W("onclickPgButtons","prev",e(A),t[1][t[0]]))return!1;if(d(e("#"+l(t[1][t[0]-1])),Y))return!1;v(t[1][t[0]-1],A),q.call(k,t[1][t[0]-1]),W("afterclickPgButtons","prev",e(A),t[1][t[0]-1]),x(t[0]-1,t)}return!1}),W("afterShowForm",e(A),S);var be=D();x(be[0],be)}}})},viewGridRow:function(t,a){return this.each(function(){function c(){!0!==C.closeOnEscape&&!0!==C.navkeys[0]||setTimeout(function(){e("#cData").focus()},0)}function v(t){var a,o,n=0,d=r.getInd.call(w,t,!0);d&&(e("td",d).each(function(t){o=A[t],"cb"!==(a=o.name)&&"subgrid"!==a&&"rn"!==a&&(a=l("v_"+a),e("#"+a+" span",F).html(i.getDataFieldOfCell.call(y,d,t).html()),n++)}),n>0&&e("#id_g",F).val(t))}function g(t,a){var i=a[1].length-1;0===t?e("#pData",_).addClass(R):void 0!==a[1][t-1]&&d(e("#"+l(a[1][t-1])),R)?e("#pData",_).addClass(R):e("#pData",_).removeClass(R),t===i?e("#nData",_).addClass(R):void 0!==a[1][t+1]&&d(e("#"+l(a[1][t+1])),R)?e("#nData",_).addClass(R):e("#nData",_).removeClass(R)}function b(){var t=r.getDataIDs.call(w),a=e("#id_g",F).val();return[e.inArray(a,t),t]}var y=this,w=e(y),x=y.p;if(y.grid&&null!=x&&t){var D=x.id,C=e.extend(!0,{top:0,left:0,width:0,datawidth:"auto",height:"auto",dataheight:"auto",drag:!0,resize:!0,closeOnEscape:!1,labelswidth:"",navkeys:[!1,38,40],onClose:null,beforeShowForm:null,beforeInitData:null,viewPagerButtons:!0,removemodal:!0},r.getGridRes.call(w,"view"),i.view||{},x.formViewing||{},a||{}),k="#ViewGrid_"+l(D),F="#ViewTbl_"+l(D),_=F+"_2",E="ViewGrid_"+D,S="ViewTbl_"+D,j=C.commonIconClass,O={themodal:"viewmod"+D,modalhead:"viewhd"+D,modalcontent:"viewcnt"+D,resizeAlso:E},q="#"+l(O.themodal),T=x.gBox,A=x.colModel,G=1,I=0,B=function(){var t=e.makeArray(arguments);return t.unshift(""),t.unshift("View"),t.unshift(C),s.apply(y,t)},N=function(){i.hideModal(q,{gb:T,jqm:C.jqModal,onClose:C.onClose,removemodal:C.removemodal})},P=f.call(y,"hover"),R=f.call(y,"disabled"),M=isNaN(C.dataheight)?C.dataheight:C.dataheight+"px",z=isNaN(C.datawidth)?C.datawidth:C.datawidth+"px",V=e("<div class='"+o.call(y,"dialog.body")+"'><form name='FormPost' id='"+E+"' class='FormGrid' style='width:"+z+";overflow:auto;position:relative;height:"+M+";'></form></div>"),L=V.children("form.FormGrid"),U=e("<table id='"+S+"' class='EditTable'><tbody></tbody></table>");if(e(q).remove(),e(A).each(function(){var e=this.formoptions;G=Math.max(G,e?e.colpos||0:0),I=Math.max(I,e?e.rowpos||0:0)}),L.append(U),B("beforeInitData",L)){!function(t,a,l){var n,d,s,c,u,p,f,v,g=0,b=[],D=r.getInd.call(w,t),k=o.call(y,"dialog.viewData"),F=e(a),_=o.call(y,"dialog.viewLabel"),E=String(C.labelswidth)+(!C.labelswidth||isNaN(C.labelswidth)?"":"px"),S="<td class='"+o.call(y,"dialog.viewCellLabel","CaptionTD form-view-label")+(E?"' style='width:"+E+";":"")+"'>&#160;</td><td class='"+o.call(y,"dialog.viewCellData","DataTD form-view-data")+"'>&#160;</td>",j="",O=["integer","number","currency"],q=0,T=0;for(u=0;u<l;u++)j+=S;if(e(A).each(function(){var t=this;(d=(!t.editrules||!0!==t.editrules.edithidden)&&!0===t.hidden)||"right"!==t.align||(t.formatter&&-1!==e.inArray(t.formatter,O)?q=Math.max(q,parseInt(t.width,10)):T=Math.max(T,parseInt(t.width,10)))}),p=0!==q?q:0!==T?T:0,e(A).each(function(t){var a=this;if(n=a.name,f=!1,d=(!a.editrules||!0!==a.editrules.edithidden)&&!0===a.hidden,v="boolean"!=typeof a.viewable||a.viewable,"cb"!==n&&"subgrid"!==n&&"rn"!==n&&v){c=!1===D?"":i.getDataFieldOfCell.call(y,y.rows[D],t).html(),f="right"===a.align&&0!==p;var r=e.extend({},{rowabove:!1,rowcontent:""},a.formoptions||{}),o=parseInt(r.rowpos,10)||g+1,u=parseInt(2*(parseInt(r.colpos,10)||1),10);if(r.rowabove){var h=e("<tr><td class='contentinfo' colspan='"+2*l+"'>"+r.rowcontent+"</td></tr>");F.append(h),h[0].rp=o}0===(s=F.find("tr[data-rowpos="+o+"]")).length&&((s=e("<tr data-rowpos='"+o+"'></tr>").addClass("FormData").attr("id","trv_"+n)).append(j),F.append(s),s[0].rp=o);var w=void 0===r.label?x.colNames[t]:r.label,C=e("td:eq("+(u-1)+")",s[0]),E=e("td:eq("+(u-2)+")",s[0]);E.html("<label for='"+n+"'"+(_?" class='"+_+"'>":">")+(w||"&nbsp;")+"</label>"),C[m(C.html())?"html":"append"]("<span id='"+n+"'"+(k?" class='"+k+"'>":">")+(c||"&nbsp;")+"</span>").attr("id","v_"+n),f&&e("td:eq("+(u-1)+") span",s[0]).css({"text-align":"right",width:p+"px"}),d&&E.add(C).css("visibility","hidden"),b[g]=t,g++}}),h(F),g>0){var G=e("<tr class='FormData' style='display:none'><td class='CaptionTD'>&#160;</td><td colspan='"+(2*l-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='id' value='"+t+"'/></td></tr>");G[0].rp=g+99,F.append(G)}}(t,U,G);var H="rtl"===x.direction,Q=H?"nData":"pData",K=H?"pData":"nData",W=u.call(y,Q,"",n(j,C.prevIcon),"","left"),X=u.call(y,K,"",n(j,C.nextIcon),"","right"),Y=u.call(y,"cData",C.bClose);if(I>0){var J=[];e.each(e(U)[0].rows,function(e,t){J[e]=t}),J.sort(function(e,t){return e.rp>t.rp?1:e.rp<t.rp?-1:0}),e.each(J,function(t,a){e("tbody",U).append(a)})}C.gbox=T;var $=e("<div></div>").append(V).append("<div class='"+o.call(y,"dialog.footer")+"'><table border='0' class='EditTable' id='"+S+"_2'><tbody><tr id='Act_Buttons'><td class='navButton navButton-"+x.direction+"' width='"+(C.labelswidth||"auto")+"'>"+(H?X+W:W+X)+"</td><td class='EditButton EditButton-"+x.direction+"'>"+Y+"</td></tr></tbody></table></div>");i.createModal.call(y,O,$,C,x.gView,e(x.gView)[0]),C.viewPagerButtons||e("#pData, #nData",_).hide(),$=null,e(q).keydown(function(t){var a,i;if(!0===e(k).data("disabled"))return!1;if(13===t.which&&(a=e(_).find(":focus"),i=a.attr("id"),a.length>0&&e.inArray(i,["pData","nData","cData"])>=0))return a.trigger("click"),!1;if(27===t.which)return C.closeOnEscape&&N(),!1;if(!0===C.navkeys[0]){if(t.which===C.navkeys[1])return e("#pData",_).trigger("click"),!1;if(t.which===C.navkeys[2])return e("#nData",_).trigger("click"),!1}}),p(e("#cData",_),C.closeicon,j),B("beforeShowForm",e(k)),i.viewModal.call(y,q,{gbox:T,jqm:C.jqModal,overlay:C.overlay,toTop:C.toTop,modal:C.modal,onHide:function(e){e.w.remove(),e.o&&e.o.remove()}}),e(".fm-button:not(."+R.split(" ").join(".")+")",_).hover(function(){e(this).addClass(P)},function(){e(this).removeClass(P)}),c(),e("#cData",_).click(function(){return N(),!1}),e("#nData",_).click(function(){e("#FormError",F).hide();var t=b();if(t[0]=parseInt(t[0],10),-1!==t[0]&&t[1][t[0]+1]){if(!B("onclickPgButtons","next",e(k),t[1][t[0]]))return!1;v(t[1][t[0]+1]),r.setSelection.call(w,t[1][t[0]+1]),B("afterclickPgButtons","next",e(k),t[1][t[0]+1]),g(t[0]+1,t)}return c(),!1}),e("#pData",_).click(function(){e("#FormError",F).hide();var t=b();if(-1!==t[0]&&t[1][t[0]-1]){if(!B("onclickPgButtons","prev",e(k),t[1][t[0]]))return!1;v(t[1][t[0]-1]),r.setSelection.call(w,t[1][t[0]-1]),B("afterclickPgButtons","prev",e(k),t[1][t[0]-1]),g(t[0]-1,t)}return c(),!1});var Z=b();g(Z[0],Z)}}})},delGridRow:function(t,a){return this.each(function(){var n=this,d=n.p,c=e(n);if(n.grid&&null!=d&&t){var h,m,v,g,b=d.id,y=e.extend(!0,{top:0,left:0,width:240,removemodal:!0,height:"auto",dataheight:"auto",datawidth:"auto",drag:!0,resize:!0,url:"",mtype:"POST",reloadAfterSubmit:!0,beforeShowForm:null,beforeInitData:null,afterShowForm:null,beforeSubmit:null,onclickSubmit:null,afterSubmit:null,closeOnEscape:!1,delData:{},onClose:null,ajaxDelOptions:{},processing:!1,serializeDelData:null,useDataProxy:!1,delui:"disable",deltext:getGridRes.call(c,"defaults.deltext")||"Deleting..."},r.getGridRes.call(c,"del"),i.del||{},d.formDeleting||{},a||{}),w="DelTbl_"+b,x="#DelTbl_"+l(b),D={themodal:"delmod"+b,modalhead:"delhd"+b,modalcontent:"delcnt"+b,resizeAlso:w},C="#"+l(D.themodal),k=d.gBox,F=y.commonIconClass,_=function(){var t=e.makeArray(arguments);return t.unshift(""),t.unshift("Delete"),t.unshift(y),s.apply(n,t)},E=f.call(n,"hover"),S=f.call(n,"active"),j=f.call(n,"error");if(e.isArray(t)||(t=[String(t)]),void 0!==e(C)[0]){if(!_("beforeInitData",e(x)))return;e("#DelData>td",x).text(t.join()).data("rowids",t),e("#DelError",x).hide(),!0===y.processing&&(y.processing=!1,e("#dData",x).removeClass(S)),_("beforeShowForm",e(x)),i.viewModal.call(n,C,{gbox:k,jqm:y.jqModal,jqM:!1,overlay:y.overlay,toTop:y.toTop,modal:y.modal}),_("afterShowForm",e(x))}else{var O=isNaN(y.dataheight)?y.dataheight:y.dataheight+"px",q=isNaN(y.datawidth)?y.datawidth:y.datawidth+"px",T="<div class='"+o.call(n,"dialog.body")+"'><div id='"+w+"' class='formdata' style='width:"+q+";overflow:auto;position:relative;height:"+O+";'>";T+="<table class='DelTable'><tbody>",T+="<tr id='DelError' style='display:none'><td class='"+j+"'></td></tr>",T+="<tr id='DelData' style='display:none'><td >"+t.join()+"</td></tr>",T+="<tr><td class='delmsg'>"+y.msg+"</td></tr>",T+="</tbody></table></div></div>";var A=u.call(n,"dData",y.bSubmit),G=u.call(n,"eData",y.bCancel);if(T+="<div class='"+o.call(n,"dialog.footer")+"'><table class='EditTable' id='"+w+"_2'><tbody><tr><td><hr class='"+o.call(n,"dialog.hr")+"' style='margin:1px'/></td></tr><tr><td class='DelButton EditButton EditButton-"+d.direction+"'>"+A+"&#160;"+G+"</td></tr></tbody></table></div>",y.gbox=k,i.createModal.call(n,D,T,y,d.gView,e(d.gView)[0]),e("#DelData>td",x).data("rowids",t),!_("beforeInitData",e(T)))return;e(".fm-button",x+"_2").hover(function(){e(this).addClass(E)},function(){e(this).removeClass(E)}),p(e("#dData",x+"_2"),y.delicon,F),p(e("#eData",x+"_2"),y.cancelicon,F),e("#dData",x+"_2").click(function(){var t,a=[!0,""],l=e("#DelData>td",x),o=l.text(),s=l.data("rowids"),u={};if(e.isFunction(y.onclickSubmit)&&(u=y.onclickSubmit.call(n,y,o)||{}),e.isFunction(y.beforeSubmit)&&(a=y.beforeSubmit.call(n,o)||a),a[0]&&!y.processing){if(y.processing=!0,v=d.prmNames,h=e.extend({},y.delData,u),g=v.oper,h[g]=v.deloper,m=v.id,!(o=s.slice()).length)return!1;for(t in o)o.hasOwnProperty(t)&&(o[t]=i.stripPref(d.idPrefix,o[t]));h[m]=o.join(),e(this).addClass(S);var p=y.url||d.editurl,f=e.extend({url:e.isFunction(p)?p.call(n,h[m],h,y):p,type:y.mtype,data:e.isFunction(y.serializeDelData)?y.serializeDelData.call(n,h):h,complete:function(t,l){var u;if(c.jqGrid("progressBar",{method:"hide",loadtype:y.delui}),e("#dData",x+"_2").removeClass(S),t.status>=300&&304!==t.status||0===t.status&&4===t.readyState?(a[0]=!1,e.isFunction(y.errorTextFormat)?a[1]=y.errorTextFormat.call(n,t):a[1]=l+" Status: '"+t.statusText+"'. Error code: "+t.status):e.isFunction(y.afterSubmit)&&(a=y.afterSubmit.call(n,t,h)||[!0]),!1===a[0])e("#DelError>td",x).html(a[1]),e("#DelError",x).show();else{if("local"===d.datatype||!0===d.treeGrid||!y.reloadAfterSubmit)if(!0===d.treeGrid)try{r.delTreeNode.call(c,s[0])}catch(e){}else for(s=s.slice(),u=0;u<s.length;u++)r.delRowData.call(c,s[u]);y.reloadAfterSubmit&&c.trigger("reloadGrid",[e.extend({},y.reloadGridOptions||{})]),setTimeout(function(){_("afterComplete",t,o,e(x))},50)}y.processing=!1,a[0]&&i.hideModal(C,{gb:k,jqm:y.jqModal,onClose:y.onClose,removemodal:y.removemodal})}},i.ajaxOptions,y.ajaxDelOptions);if(f.url||y.useDataProxy||(e.isFunction(d.dataProxy)?y.useDataProxy=!0:(a[0]=!1,a[1]+=" "+i.errors.nourl)),a[0])if(c.jqGrid("progressBar",{method:"show",loadtype:y.delui,htmlcontent:y.deltext}),y.useDataProxy){var w=d.dataProxy.call(n,f,"del_"+b);void 0===w&&(w=[!0,""]),!1===w[0]?(a[0]=!1,a[1]=w[1]||"Error deleting the selected row!"):i.hideModal(C,{gb:k,jqm:y.jqModal,onClose:y.onClose,removemodal:y.removemodal})}else"clientArray"===f.url?(h=f.data,f.complete({status:200,statusText:""},"")):e.ajax(f)}return!1===a[0]&&(e("#DelError>td",x).html(a[1]),e("#DelError",x).show()),!1}),e("#eData",x+"_2").click(function(){return i.hideModal(C,{gb:k,jqm:y.jqModal,onClose:y.onClose,removemodal:y.removemodal}),!1}),_("beforeShowForm",e(x)),i.viewModal.call(n,C,{gbox:k,jqm:y.jqModal,overlay:y.overlay,toTop:y.toTop,modal:y.modal}),_("afterShowForm",e(x))}!0===y.closeOnEscape&&setTimeout(function(){e(".ui-jqdialog-titlebar-close","#"+l(D.modalhead)).attr("tabindex","-1").focus()},0)}})},navGrid:function(s,c,u,p,h,m,v){return"object"==typeof s&&(v=m,m=h,h=p,p=u,u=c,c=s,s=void 0),p=p||{},u=u||{},v=v||{},h=h||{},m=m||{},this.each(function(){var g=this,b=g.p,y=e(g);if(g.grid&&null!=b&&!(g.nav&&e(s).find(".navtable").length>0)){var w=b.id,x=e.extend({edit:!0,add:!0,del:!0,search:!0,refresh:!0,refreshstate:"firstpage",view:!1,closeOnEscape:!0,beforeRefresh:null,afterRefresh:null,cloneToTop:!1,hideEmptyPagerParts:!0,alertwidth:200,alertheight:"auto",alerttop:null,removemodal:!0,alertleft:null,alertzIndex:null,iconsOverText:!1},r.getGridRes.call(y,"nav"),i.nav||{},b.navOptions||{},c||{});x.position=x.position||("rtl"===b.direction?"right":"left");var D,C,k,F=b.idSel,_=b.gBox,E=x.commonIconClass,S={themodal:"alertmod_"+w,modalhead:"alerthd_"+w,modalcontent:"alertcnt_"+w},j=function(){var r=a.documentElement,n=t,d=1024,s=768,c=y.closest(".ui-jqgrid").offset();void 0===e("#"+l(S.themodal))[0]&&(x.alerttop||x.alertleft||(void 0!==n.innerWidth?(d=n.innerWidth,s=n.innerHeight):null!=r&&void 0!==r.clientWidth&&0!==r.clientWidth&&(d=r.clientWidth,s=r.clientHeight),d=d/2-parseInt(x.alertwidth,10)/2-c.left+n.scrollX,s=s/2-25-c.top+n.scrollY),i.createModal.call(g,S,"<div class='"+o.call(g,"dialog.body")+"'><div>"+x.alerttext+"</div></div>",{gbox:_,jqModal:x.jqModal,drag:!0,resize:!0,caption:x.alertcap,top:null!=x.alerttop?x.alerttop:s,left:null!=x.alertleft?x.alertleft:d,width:x.alertwidth,height:x.alertheight,closeOnEscape:x.closeOnEscape,zIndex:x.alertzIndex,removemodal:x.removemodal},b.gView,e(_)[0],!1)),i.viewModal.call(g,"#"+l(S.themodal),{gbox:_,toTop:x.alertToTop,jqm:x.jqModal});var u=e("#"+l(S.modalhead)).find(".ui-jqdialog-titlebar-close");u.attr({tabindex:"0",href:"#",role:"button"}),setTimeout(function(){u.focus()},50)},O=f.call(g,"hover"),q=f.call(g,"disabled"),T=o.call(g,"navButton","ui-pg-button");if(g.grid){g.modalAlert=j,void 0===s&&(b.pager?(s=b.pager,b.toppager&&(x.cloneToTop=!0)):b.toppager&&(s=b.toppager));var A,G,I,B,N,P,R,M=1,z=["left","center","right"],V="<div class='"+o.call(g,"navButton","ui-pg-button "+f.call(g,"disabled"))+"'><span class='ui-separator'></span></div>",L=function(){d(this,q)||e(this).addClass(O)},U=function(){e(this).removeClass(O)},H=function(t,a,i){if(!d(this,q)){var l=b.selrow;l?e.isFunction(t)?t.call(g,l,i):r[a].call(y,l,i):j()}return!1},Q=function(t,a,i){var l=e("<div class='"+T+"' tabindex='0' role='button'></div>"),r=x[t+"icon"],o=e.trim(x[t+"text"]);return l.append("<div class='ui-pg-div'><span class='"+(x.iconsOverText?n("ui-pg-button-icon-over-text",E,r):n(E,r))+"'></span>"+(o?"<span class='ui-pg-button-text"+(x.iconsOverText?" ui-pg-button-icon-over-text":"")+"'>"+o+"</span>":"")+"</div>"),e(k).append(l),l.attr({title:x[t+"title"]||"",id:a||t+"_"+B}).click(i).hover(L,U),l};for(x.cloneToTop&&b.toppager&&(M=2),A=0;A<M;A++){if(k=e("<div class='ui-pg-table navtable' role='toolbar' style='float:"+("rtl"===b.direction?"right":"left")+";table-layout:auto;'></div>"),0===A?(B=w,(I=s)===b.toppager&&(B+="_top",M=1)):(I=b.toppager,B=w+"_top"),x.add&&Q("add",p.id,function(){return d(this,q)||(e.isFunction(x.addfunc)?x.addfunc.call(g,p):r.editGridRow.call(y,"new",p)),!1}),x.edit&&Q("edit",u.id,function(){return H.call(this,x.editfunc,"editGridRow",u)}),x.view&&Q("view",v.id,function(){return H.call(this,x.viewfunc,"viewGridRow",v)}),x.del&&Q("del",h.id,function(){var t;return d(this,q)||(b.multiselect?0===(t=b.selarrrow).length&&(t=null):t=b.selrow,t?e.isFunction(x.delfunc)?x.delfunc.call(g,t,h):r.delGridRow.call(y,t,h):j()),!1}),(x.add||x.edit||x.del||x.view)&&e(k).append(V),x.search&&(G=Q("search",m.id,function(){return d(this,q)||(e.isFunction(x.searchfunc)?x.searchfunc.call(g,m):r.searchGrid.call(y,m)),!1}),m.showOnLoad&&!0===m.showOnLoad&&e(G,k).click()),x.refresh&&Q("refresh","",function(){if(!d(this,q)){e.isFunction(x.beforeRefresh)&&x.beforeRefresh.call(g),b.search=!1,b.resetsearch=!0;try{if("currentfilter"!==x.refreshstate){b.postData.filters="";try{e("#fbox_"+F).jqFilter("resetFilter")}catch(e){}e.isFunction(g.clearToolbar)&&g.clearToolbar(!1)}}catch(e){}switch(x.refreshstate){case"firstpage":y.trigger("reloadGrid",[e.extend({},x.reloadGridOptions||{},{page:1})]);break;case"current":case"currentfilter":y.trigger("reloadGrid",[e.extend({},x.reloadGridOptions||{},{current:!0})])}e.isFunction(x.afterRefresh)&&x.afterRefresh.call(g)}return!1}),C=e(".ui-jqgrid>.ui-jqgrid-view").css("font-size")||"11px",e("body").append("<div id='testpg2' class='"+o.call(g,"gBox","ui-jqgrid")+"' style='font-size:"+C+";visibility:hidden;' ></div>"),D=e(k).clone().appendTo("#testpg2").width(),e("#testpg2").remove(),e(I+"_"+x.position,I).append(k),x.hideEmptyPagerParts)for(N=0;N<z.length;N++)z[N]!==x.position&&(0===(R=e(I+"_"+z[N],I)).length||0===R[0].childNodes.length?R.hide():1===R[0].childNodes.length&&(P=R[0].firstChild,!e(P).is("table.ui-pg-table")||0!==P.rows&&0!==P.rows[0].cells.length||R.hide()));b._nvtd&&(D>b._nvtd[0]&&(e(I+"_"+x.position,I).width(D),b._nvtd[0]=D),b._nvtd[1]=D),g.nav=!0,k.on("keydown.jqGrid",function(t){var a;if(13===t.which&&(a=e(this).find(".ui-pg-button").filter(":focus")).length>0){var i=a[0].id,l=i.substr(0,e(this).closest(".ui-jqgrid-toppager").length>0?i.length-w.length-5:i.length-w.length-1)+"mod"+b.id,r=e(".ui-jqdialog").filter(":visible").map(function(){return this.id});if(e.inArray(l,r)<0)return a.trigger("click"),!1}})}y.triggerHandler("jqGridResetFrozenHeights")}}})},navButtonAdd:function(t,a){return"object"==typeof t&&(a=t,t=void 0),this.each(function(){var s=this,c=s.p;if(s.grid){var u=e.extend({caption:"newButton",title:"",onClickButton:null,position:"last",iconsOverText:!1},r.getGridRes.call(e(s),"nav"),i.nav||{},c.navOptions||{},a||{}),p=u.id,h=f.call(s,"hover"),m=f.call(s,"disabled"),v=o.call(s,"navButton","ui-pg-button");if(void 0===t)if(c.pager){if(r.navButtonAdd.call(e(s),c.pager,u),!c.toppager)return;t=c.toppager,p&&(p+="_top")}else c.toppager&&(t=c.toppager);"string"==typeof t&&0!==t.indexOf("#")&&(t="#"+l(t));var g=e(".navtable",t),b=u.commonIconClass;if(g.length>0){if(p&&g.find("#"+l(p)).length>0)return;var y=e("<div tabindex='0' role='button'></div>");"NONE"===u.buttonicon.toString().toUpperCase()?e(y).addClass(v).append("<div class='ui-pg-div'>"+(u.caption?"<span class='ui-pg-button-text"+(u.iconsOverText?" ui-pg-button-icon-over-text":"")+"'>"+u.caption+"</span>":"")+"</div>"):e(y).addClass(v).append("<div class='ui-pg-div'><span class='"+(u.iconsOverText?n("ui-pg-button-icon-over-text",b,u.buttonicon):n(b,u.buttonicon))+"'></span>"+(u.caption?"<span class='ui-pg-button-text"+(u.iconsOverText?" ui-pg-button-icon-over-text":"")+"'>"+u.caption+"</span>":"")+"</div>"),p&&e(y).attr("id",p),"first"===u.position&&g.children("div.ui-pg-button").length>0?g.children("div.ui-pg-button").first().before(y):g.append(y),e(y,g).attr("title",u.title||"").click(function(t){return d(this,m)||e.isFunction(u.onClickButton)&&u.onClickButton.call(s,u,t),!1}).hover(function(){d(this,m)||e(this).addClass(h)},function(){e(this).removeClass(h)}),e(s).triggerHandler("jqGridResetFrozenHeights")}}})},navSeparatorAdd:function(t,a){return a=e.extend({sepclass:"ui-separator",sepcontent:"",position:"last"},a||{}),this.each(function(){if(this.grid){var i=this,n=i.p,d=o.call(i,"navButton","ui-pg-button "+f.call(i,"disabled"));if(void 0===t)if(n.pager){if(r.navSeparatorAdd.call(e(i),n.pager,a),!n.toppager)return;t=n.toppager}else n.toppager&&(t=n.toppager);"string"==typeof t&&0!==t.indexOf("#")&&(t="#"+l(t));var s=e(".navtable",t);if(s.length>0){var c="<div class='"+d+"'><span class='"+a.sepclass+"'></span>"+a.sepcontent+"</div>";"first"===a.position?0===s.children("div.ui-pg-button").length?s.append(c):s.children("div.ui-pg-button").first().before(c):s.append(c)}}})},GridToForm:function(t,a){return this.each(function(){var i,o,n,d,s=this;if(s.grid){var c=r.getRowData.call(e(s),t);if(c)for(i in c)if(c.hasOwnProperty(i))if((o=e("[name="+l(i)+"]",a)).is("input:radio")||o.is("input:checkbox"))for(n=0;n<o.length;n++)(d=e(o[n])).prop("checked",d.val()===String(c[i]));else o.val(m(c[i])?"":c[i])}})},FormToGrid:function(t,a,i,l){return this.each(function(){var o=this;if(o.grid){i||(i="set"),l||(l="first");var n=e(a).serializeArray(),d={};e.each(n,function(e,t){d[t.name]=t.value}),"add"===i?r.addRowData.call(e(o),t,d,l):"set"===i&&r.setRowData.call(e(o),t,d)}})}})});
//# sourceMappingURL=grid.formedit.js.map